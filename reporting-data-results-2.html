<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>R Programming for Research</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016.">
  <meta name="generator" content="bookdown 0.3.7 and GitBook 2.6.7">

  <meta property="og:title" content="R Programming for Research" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="R Programming for Research" />
  
  <meta name="twitter:description" content="This is a bookdown version of the course notes for R Programming for Research, Colorado State University, Fall 2016." />
  

<meta name="author" content="Brooke Anderson and Rachel Severson">


<meta name="date" content="2017-01-13">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="exploring-data-2.html">
<link rel="next" href="reproducible-research-2.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.8/htmlwidgets.js"></script>
<link href="libs/plotlyjs-1.20.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotlyjs-1.20.2/plotly-latest.min.js"></script>
<script src="libs/plotly-binding-4.5.6.9000/plotly.js"></script>
<link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/bokehjs-0.12.2/bokeh.min.css" rel="stylesheet" />
<link href="libs/bokehjs-0.12.2/loader.css" rel="stylesheet" />
<script src="libs/bokehjs-0.12.2/bokeh.min.js"></script>
<script src="libs/rbokeh-binding-0.5.0/rbokeh.js"></script>
<link href="libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet" />
<script src="libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="libs/moment-2.8.4/moment.js"></script>
<script src="libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="libs/dygraphs-binding-1.1.1.4/dygraphs.js"></script>
<script src="libs/datatables-binding-0.2/datatables.js"></script>
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.12/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.12/js/jquery.dataTables.min.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R Programming for Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Online course book, ERHS 535</a></li>
<li class="chapter" data-level="" data-path="course-information.html"><a href="course-information.html"><i class="fa fa-check"></i>Course information</a><ul>
<li class="chapter" data-level="0.1" data-path="course-information.html"><a href="course-information.html#course-overview"><i class="fa fa-check"></i><b>0.1</b> Course overview</a></li>
<li class="chapter" data-level="0.2" data-path="course-information.html"><a href="course-information.html#time-and-place"><i class="fa fa-check"></i><b>0.2</b> Time and place</a></li>
<li class="chapter" data-level="0.3" data-path="course-information.html"><a href="course-information.html#detailed-schedule"><i class="fa fa-check"></i><b>0.3</b> Detailed schedule</a></li>
<li class="chapter" data-level="0.4" data-path="course-information.html"><a href="course-information.html#grading"><i class="fa fa-check"></i><b>0.4</b> Grading</a><ul>
<li class="chapter" data-level="0.4.1" data-path="course-information.html"><a href="course-information.html#attendance-and-class-participation"><i class="fa fa-check"></i><b>0.4.1</b> Attendance and class participation</a></li>
<li class="chapter" data-level="0.4.2" data-path="course-information.html"><a href="course-information.html#weekly-in-course-group-exercises"><i class="fa fa-check"></i><b>0.4.2</b> Weekly in-course group exercises</a></li>
<li class="chapter" data-level="0.4.3" data-path="course-information.html"><a href="course-information.html#in-class-quizzes"><i class="fa fa-check"></i><b>0.4.3</b> In-class quizzes</a></li>
<li class="chapter" data-level="0.4.4" data-path="course-information.html"><a href="course-information.html#homework"><i class="fa fa-check"></i><b>0.4.4</b> Homework</a></li>
<li class="chapter" data-level="0.4.5" data-path="course-information.html"><a href="course-information.html#final-group-project"><i class="fa fa-check"></i><b>0.4.5</b> Final group project</a></li>
</ul></li>
<li class="chapter" data-level="0.5" data-path="course-information.html"><a href="course-information.html#course-set-up"><i class="fa fa-check"></i><b>0.5</b> Course set-up</a></li>
<li class="chapter" data-level="0.6" data-path="course-information.html"><a href="course-information.html#helpful-books-for-learning-r"><i class="fa fa-check"></i><b>0.6</b> Helpful books for learning R</a></li>
</ul></li>
<li class="part"><span><b>I Part I: Preliminaries</b></span></li>
<li class="chapter" data-level="1" data-path="r-preliminaries.html"><a href="r-preliminaries.html"><i class="fa fa-check"></i><b>1</b> R Preliminaries</a><ul>
<li class="chapter" data-level="1.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-and-r-studio"><i class="fa fa-check"></i><b>1.1</b> R and R Studio</a><ul>
<li class="chapter" data-level="1.1.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-r"><i class="fa fa-check"></i><b>1.1.1</b> What is R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#open-source-software"><i class="fa fa-check"></i><b>1.1.2</b> Open-source software</a></li>
<li class="chapter" data-level="1.1.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#what-is-rstudio"><i class="fa fa-check"></i><b>1.1.3</b> What is RStudio?</a></li>
<li class="chapter" data-level="1.1.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#setting-up"><i class="fa fa-check"></i><b>1.1.4</b> Setting up</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#the-package-system"><i class="fa fa-check"></i><b>1.2</b> The “package” system</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#r-packages"><i class="fa fa-check"></i><b>1.2.1</b> R packages</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#installing-from-cran"><i class="fa fa-check"></i><b>1.2.2</b> Installing from CRAN</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#loading-an-installed-package"><i class="fa fa-check"></i><b>1.2.3</b> Loading an installed package</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#basic-code-conventions-of-r"><i class="fa fa-check"></i><b>1.3</b> Basic code conventions of R</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-mvp-the-gets-arrow"><i class="fa fa-check"></i><b>1.3.1</b> R’s MVP: The <em>gets arrow</em></a></li>
<li class="chapter" data-level="1.3.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#assignment-operator-wars---vs."><i class="fa fa-check"></i><b>1.3.2</b> Assignment operator wars: <code>&lt;-</code> vs. <code>=</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#naming-objects"><i class="fa fa-check"></i><b>1.3.3</b> Naming objects</a></li>
<li class="chapter" data-level="1.3.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#commenting-code"><i class="fa fa-check"></i><b>1.3.4</b> Commenting code</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#rs-most-basic-object-types"><i class="fa fa-check"></i><b>1.4</b> R’s most basic object types</a><ul>
<li class="chapter" data-level="1.4.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#vectors"><i class="fa fa-check"></i><b>1.4.1</b> Vectors</a></li>
<li class="chapter" data-level="1.4.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#dataframes"><i class="fa fa-check"></i><b>1.4.2</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-r-functions"><i class="fa fa-check"></i><b>1.5</b> Using R functions</a><ul>
<li class="chapter" data-level="1.5.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-structure"><i class="fa fa-check"></i><b>1.5.1</b> Function structure</a></li>
<li class="chapter" data-level="1.5.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-help-files"><i class="fa fa-check"></i><b>1.5.2</b> Function help files</a></li>
<li class="chapter" data-level="1.5.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#function-parameters"><i class="fa fa-check"></i><b>1.5.3</b> Function parameters</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="r-preliminaries.html"><a href="r-preliminaries.html#in-course-exercise"><i class="fa fa-check"></i><b>1.6</b> In-course Exercise</a><ul>
<li class="chapter" data-level="1.6.1" data-path="r-preliminaries.html"><a href="r-preliminaries.html#about-the-dataset"><i class="fa fa-check"></i><b>1.6.1</b> About the dataset</a></li>
<li class="chapter" data-level="1.6.2" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-onto-your-computer"><i class="fa fa-check"></i><b>1.6.2</b> Getting the data onto your computer</a></li>
<li class="chapter" data-level="1.6.3" data-path="r-preliminaries.html"><a href="r-preliminaries.html#getting-the-data-into-r"><i class="fa fa-check"></i><b>1.6.3</b> Getting the data into R</a></li>
<li class="chapter" data-level="1.6.4" data-path="r-preliminaries.html"><a href="r-preliminaries.html#checking-out-the-data"><i class="fa fa-check"></i><b>1.6.4</b> Checking out the data</a></li>
<li class="chapter" data-level="1.6.5" data-path="r-preliminaries.html"><a href="r-preliminaries.html#using-the-data-to-answer-questions"><i class="fa fa-check"></i><b>1.6.5</b> Using the data to answer questions</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Part II: Basics</b></span></li>
<li class="chapter" data-level="2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html"><i class="fa fa-check"></i><b>2</b> Entering and cleaning data #1</a><ul>
<li class="chapter" data-level="2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#r-scripts"><i class="fa fa-check"></i><b>2.1</b> R scripts</a></li>
<li class="chapter" data-level="2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directories-and-pathnames"><i class="fa fa-check"></i><b>2.2</b> Directories and pathnames</a><ul>
<li class="chapter" data-level="2.2.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#directory-structure"><i class="fa fa-check"></i><b>2.2.1</b> Directory structure</a></li>
<li class="chapter" data-level="2.2.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#working-directory"><i class="fa fa-check"></i><b>2.2.2</b> Working directory</a></li>
<li class="chapter" data-level="2.2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#file-and-directory-pathnames"><i class="fa fa-check"></i><b>2.2.3</b> File and directory pathnames</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#diversion-paste"><i class="fa fa-check"></i><b>2.3</b> Diversion: <code>paste</code></a></li>
<li class="chapter" data-level="2.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-data-into-r"><i class="fa fa-check"></i><b>2.4</b> Reading data into R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-local-flat-files"><i class="fa fa-check"></i><b>2.4.1</b> Reading local flat files</a></li>
<li class="chapter" data-level="2.4.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#the-read_-functions"><i class="fa fa-check"></i><b>2.4.2</b> The <code>read_*</code> functions</a></li>
<li class="chapter" data-level="2.4.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-online-flat-files"><i class="fa fa-check"></i><b>2.4.3</b> Reading online flat files</a></li>
<li class="chapter" data-level="2.4.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#saving-and-loading-r-objects"><i class="fa fa-check"></i><b>2.4.4</b> Saving and loading R objects</a></li>
<li class="chapter" data-level="2.4.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-other-file-types"><i class="fa fa-check"></i><b>2.4.5</b> Reading other file types</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#data-cleaning"><i class="fa fa-check"></i><b>2.5</b> Data cleaning</a><ul>
<li class="chapter" data-level="2.5.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#renaming-columns"><i class="fa fa-check"></i><b>2.5.1</b> Renaming columns</a></li>
<li class="chapter" data-level="2.5.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#selecting-columns"><i class="fa fa-check"></i><b>2.5.2</b> Selecting columns</a></li>
<li class="chapter" data-level="2.5.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#filtering-to-certain-rows"><i class="fa fa-check"></i><b>2.5.3</b> Filtering to certain rows</a></li>
<li class="chapter" data-level="2.5.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#add-or-change-columns"><i class="fa fa-check"></i><b>2.5.4</b> Add or change columns</a></li>
<li class="chapter" data-level="2.5.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#piping"><i class="fa fa-check"></i><b>2.5.5</b> Piping</a></li>
<li class="chapter" data-level="2.5.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#base-r-equivalents-to-dplyr-functions"><i class="fa fa-check"></i><b>2.5.6</b> Base R equivalents to <code>dplyr</code> functions</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#dates-in-r"><i class="fa fa-check"></i><b>2.6</b> Dates in R</a></li>
<li class="chapter" data-level="2.7" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#in-course-exercise-1"><i class="fa fa-check"></i><b>2.7</b> In-course Exercise</a><ul>
<li class="chapter" data-level="2.7.1" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#checking-out-directory-structures"><i class="fa fa-check"></i><b>2.7.1</b> Checking out directory structures</a></li>
<li class="chapter" data-level="2.7.2" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#using-relative-and-absolute-file-pathnames"><i class="fa fa-check"></i><b>2.7.2</b> Using relative and absolute file pathnames</a></li>
<li class="chapter" data-level="2.7.3" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#reading-in-different-types-of-files"><i class="fa fa-check"></i><b>2.7.3</b> Reading in different types of files</a></li>
<li class="chapter" data-level="2.7.4" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#cleaning-up-data"><i class="fa fa-check"></i><b>2.7.4</b> Cleaning up data</a></li>
<li class="chapter" data-level="2.7.5" data-path="entering-and-cleaning-data-1.html"><a href="entering-and-cleaning-data-1.html#a-taste-of-whats-to-come"><i class="fa fa-check"></i><b>2.7.5</b> A taste of what’s to come…</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploring-data-1.html"><a href="exploring-data-1.html"><i class="fa fa-check"></i><b>3</b> Exploring data #1</a><ul>
<li class="chapter" data-level="3.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#data-from-a-package"><i class="fa fa-check"></i><b>3.1</b> Data from a package</a></li>
<li class="chapter" data-level="3.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#plots-to-explore-data"><i class="fa fa-check"></i><b>3.2</b> Plots to explore data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#initializing-a-ggplot-object"><i class="fa fa-check"></i><b>3.2.1</b> Initializing a ggplot object</a></li>
<li class="chapter" data-level="3.2.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#plot-aesthetics"><i class="fa fa-check"></i><b>3.2.2</b> Plot aesthetics</a></li>
<li class="chapter" data-level="3.2.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#adding-geoms"><i class="fa fa-check"></i><b>3.2.3</b> Adding geoms</a></li>
<li class="chapter" data-level="3.2.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#constant-aesthetics"><i class="fa fa-check"></i><b>3.2.4</b> Constant aesthetics</a></li>
<li class="chapter" data-level="3.2.5" data-path="exploring-data-1.html"><a href="exploring-data-1.html#useful-plot-additions"><i class="fa fa-check"></i><b>3.2.5</b> Useful plot additions</a></li>
<li class="chapter" data-level="3.2.6" data-path="exploring-data-1.html"><a href="exploring-data-1.html#example-dataset"><i class="fa fa-check"></i><b>3.2.6</b> Example dataset</a></li>
<li class="chapter" data-level="3.2.7" data-path="exploring-data-1.html"><a href="exploring-data-1.html#histograms"><i class="fa fa-check"></i><b>3.2.7</b> Histograms</a></li>
<li class="chapter" data-level="3.2.8" data-path="exploring-data-1.html"><a href="exploring-data-1.html#scatterplots"><i class="fa fa-check"></i><b>3.2.8</b> Scatterplots</a></li>
<li class="chapter" data-level="3.2.9" data-path="exploring-data-1.html"><a href="exploring-data-1.html#boxplots"><i class="fa fa-check"></i><b>3.2.9</b> Boxplots</a></li>
<li class="chapter" data-level="3.2.10" data-path="exploring-data-1.html"><a href="exploring-data-1.html#extensions-of-ggplot2"><i class="fa fa-check"></i><b>3.2.10</b> Extensions of <code>ggplot2</code></a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#simple-statistics-functions"><i class="fa fa-check"></i><b>3.3</b> Simple statistics functions</a><ul>
<li class="chapter" data-level="3.3.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#summary-statistics"><i class="fa fa-check"></i><b>3.3.1</b> Summary statistics</a></li>
<li class="chapter" data-level="3.3.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#summarize-function"><i class="fa fa-check"></i><b>3.3.2</b> <code>summarize</code> function</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#logical-vectors"><i class="fa fa-check"></i><b>3.4</b> Logical vectors</a></li>
<li class="chapter" data-level="3.5" data-path="exploring-data-1.html"><a href="exploring-data-1.html#regression-models"><i class="fa fa-check"></i><b>3.5</b> Regression models</a><ul>
<li class="chapter" data-level="3.5.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#formula-structure"><i class="fa fa-check"></i><b>3.5.1</b> Formula structure</a></li>
<li class="chapter" data-level="3.5.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#linear-models"><i class="fa fa-check"></i><b>3.5.2</b> Linear models</a></li>
<li class="chapter" data-level="3.5.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#generalized-linear-models-glms"><i class="fa fa-check"></i><b>3.5.3</b> Generalized linear models (GLMs)</a></li>
<li class="chapter" data-level="3.5.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#references-statistics-in-r"><i class="fa fa-check"></i><b>3.5.4</b> References– statistics in R</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="exploring-data-1.html"><a href="exploring-data-1.html#in-course-exercise-2"><i class="fa fa-check"></i><b>3.6</b> In-course exercise</a><ul>
<li class="chapter" data-level="3.6.1" data-path="exploring-data-1.html"><a href="exploring-data-1.html#loading-data-from-an-r-package"><i class="fa fa-check"></i><b>3.6.1</b> Loading data from an R package</a></li>
<li class="chapter" data-level="3.6.2" data-path="exploring-data-1.html"><a href="exploring-data-1.html#basic-plots-of-the-data"><i class="fa fa-check"></i><b>3.6.2</b> Basic plots of the data</a></li>
<li class="chapter" data-level="3.6.3" data-path="exploring-data-1.html"><a href="exploring-data-1.html#exploring-the-data-using-simple-statistics-and-logical-statements"><i class="fa fa-check"></i><b>3.6.3</b> Exploring the data using simple statistics and logical statements</a></li>
<li class="chapter" data-level="3.6.4" data-path="exploring-data-1.html"><a href="exploring-data-1.html#using-regression-models-to-explore-data"><i class="fa fa-check"></i><b>3.6.4</b> Using regression models to explore data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html"><i class="fa fa-check"></i><b>4</b> Reporting data results #1</a><ul>
<li class="chapter" data-level="4.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#guidelines-for-good-plots"><i class="fa fa-check"></i><b>4.1</b> Guidelines for good plots</a></li>
<li class="chapter" data-level="4.2" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#high-data-density"><i class="fa fa-check"></i><b>4.2</b> High data density</a></li>
<li class="chapter" data-level="4.3" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#meaningful-labels"><i class="fa fa-check"></i><b>4.3</b> Meaningful labels</a></li>
<li class="chapter" data-level="4.4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#references"><i class="fa fa-check"></i><b>4.4</b> References</a></li>
<li class="chapter" data-level="4.5" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#highlighting"><i class="fa fa-check"></i><b>4.5</b> Highlighting</a></li>
<li class="chapter" data-level="4.6" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#order"><i class="fa fa-check"></i><b>4.6</b> Order</a></li>
<li class="chapter" data-level="4.7" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#small-multiples"><i class="fa fa-check"></i><b>4.7</b> Small multiples</a></li>
<li class="chapter" data-level="4.8" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#advanced-customization"><i class="fa fa-check"></i><b>4.8</b> Advanced customization</a><ul>
<li class="chapter" data-level="4.8.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#scales"><i class="fa fa-check"></i><b>4.8.1</b> Scales</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#to-find-out-more"><i class="fa fa-check"></i><b>4.9</b> To find out more</a></li>
<li class="chapter" data-level="4.10" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#in-course-exercise-3"><i class="fa fa-check"></i><b>4.10</b> In-course exercise</a><ul>
<li class="chapter" data-level="4.10.1" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#designing-a-plot"><i class="fa fa-check"></i><b>4.10.1</b> Designing a plot</a></li>
<li class="chapter" data-level="4.10.2" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#basic-scatterplots-with-r-base-graphics-and-ggplot"><i class="fa fa-check"></i><b>4.10.2</b> Basic scatterplots with R base graphics and ggplot</a></li>
<li class="chapter" data-level="4.10.3" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#fancier-graphs"><i class="fa fa-check"></i><b>4.10.3</b> Fancier graphs</a></li>
<li class="chapter" data-level="4.10.4" data-path="reporting-data-results-1.html"><a href="reporting-data-results-1.html#data-visualization-cheatsheet"><i class="fa fa-check"></i><b>4.10.4</b> Data visualization cheatsheet</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html"><i class="fa fa-check"></i><b>5</b> Reproducible research #1</a><ul>
<li class="chapter" data-level="5.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#what-is-reproducible-research"><i class="fa fa-check"></i><b>5.1</b> What is reproducible research?</a></li>
<li class="chapter" data-level="5.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#markdown"><i class="fa fa-check"></i><b>5.2</b> Markdown</a></li>
<li class="chapter" data-level="5.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#literate-programming-in-r"><i class="fa fa-check"></i><b>5.3</b> Literate programming in R</a></li>
<li class="chapter" data-level="5.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#style-guidelines"><i class="fa fa-check"></i><b>5.4</b> Style guidelines</a><ul>
<li class="chapter" data-level="5.4.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#line-length"><i class="fa fa-check"></i><b>5.4.1</b> Line length</a></li>
<li class="chapter" data-level="5.4.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#spacing"><i class="fa fa-check"></i><b>5.4.2</b> Spacing</a></li>
<li class="chapter" data-level="5.4.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#semicolons"><i class="fa fa-check"></i><b>5.4.3</b> Semicolons</a></li>
<li class="chapter" data-level="5.4.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#commenting"><i class="fa fa-check"></i><b>5.4.4</b> Commenting</a></li>
<li class="chapter" data-level="5.4.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#indentation"><i class="fa fa-check"></i><b>5.4.5</b> Indentation</a></li>
<li class="chapter" data-level="5.4.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#code-grouping"><i class="fa fa-check"></i><b>5.4.6</b> Code grouping</a></li>
<li class="chapter" data-level="5.4.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#broader-guidelines"><i class="fa fa-check"></i><b>5.4.7</b> Broader guidelines</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#more-with-knitr"><i class="fa fa-check"></i><b>5.5</b> More with knitr</a><ul>
<li class="chapter" data-level="5.5.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#equations-in-knitr"><i class="fa fa-check"></i><b>5.5.1</b> Equations in <code>knitr</code></a></li>
<li class="chapter" data-level="5.5.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#figures-from-file"><i class="fa fa-check"></i><b>5.5.2</b> Figures from file</a></li>
<li class="chapter" data-level="5.5.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#saving-graphics-files"><i class="fa fa-check"></i><b>5.5.3</b> Saving graphics files</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#saving-graphics-files-1"><i class="fa fa-check"></i><b>5.6</b> Saving graphics files</a><ul>
<li class="chapter" data-level="5.6.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#tables-in-r-markdown"><i class="fa fa-check"></i><b>5.6.1</b> Tables in R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#in-course-exercise-4"><i class="fa fa-check"></i><b>5.7</b> In-course exercise</a><ul>
<li class="chapter" data-level="5.7.1" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#creating-a-markdown-document"><i class="fa fa-check"></i><b>5.7.1</b> Creating a Markdown document</a></li>
<li class="chapter" data-level="5.7.2" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#adding-in-r-code"><i class="fa fa-check"></i><b>5.7.2</b> Adding in R code</a></li>
<li class="chapter" data-level="5.7.3" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#working-with-r-markdown-documents"><i class="fa fa-check"></i><b>5.7.3</b> Working with R Markdown documents</a></li>
<li class="chapter" data-level="5.7.4" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#r-style-guidelines"><i class="fa fa-check"></i><b>5.7.4</b> R style guidelines</a></li>
<li class="chapter" data-level="5.7.5" data-path="reproducible-research-1.html"><a href="reproducible-research-1.html#trying-out-knitr-with-your-own-data"><i class="fa fa-check"></i><b>5.7.5</b> Trying out <code>knitr</code> with your own data</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>III Part III: Intermediate</b></span></li>
<li class="chapter" data-level="6" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html"><i class="fa fa-check"></i><b>6</b> Entering and cleaning data #2</a><ul>
<li class="chapter" data-level="6.1" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#joining-datasets"><i class="fa fa-check"></i><b>6.1</b> Joining datasets</a></li>
<li class="chapter" data-level="6.2" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#tidy-data"><i class="fa fa-check"></i><b>6.2</b> Tidy data</a></li>
<li class="chapter" data-level="6.3" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#gathering"><i class="fa fa-check"></i><b>6.3</b> Gathering</a></li>
<li class="chapter" data-level="6.4" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#in-course-exercise-5"><i class="fa fa-check"></i><b>6.4</b> In-course exercise</a><ul>
<li class="chapter" data-level="6.4.1" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#designing-tidy-data"><i class="fa fa-check"></i><b>6.4.1</b> Designing tidy data</a></li>
<li class="chapter" data-level="6.4.2" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#easier-data-wrangling"><i class="fa fa-check"></i><b>6.4.2</b> Easier data wrangling</a></li>
<li class="chapter" data-level="6.4.3" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#more-extensive-data-wrangling"><i class="fa fa-check"></i><b>6.4.3</b> More extensive data wrangling</a></li>
<li class="chapter" data-level="6.4.4" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#tidying-vadeaths-data"><i class="fa fa-check"></i><b>6.4.4</b> Tidying <code>VADeaths</code> data</a></li>
<li class="chapter" data-level="6.4.5" data-path="entering-and-cleaning-data-2.html"><a href="entering-and-cleaning-data-2.html#exploring-fatality-analysis-reporting-system-fars-data"><i class="fa fa-check"></i><b>6.4.5</b> Exploring Fatality Analysis Reporting System (FARS) data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exploring-data-2.html"><a href="exploring-data-2.html"><i class="fa fa-check"></i><b>7</b> Exploring data #2</a><ul>
<li class="chapter" data-level="7.1" data-path="exploring-data-2.html"><a href="exploring-data-2.html#parentheses"><i class="fa fa-check"></i><b>7.1</b> Parentheses</a></li>
<li class="chapter" data-level="7.2" data-path="exploring-data-2.html"><a href="exploring-data-2.html#loops"><i class="fa fa-check"></i><b>7.2</b> Loops</a></li>
<li class="chapter" data-level="7.3" data-path="exploring-data-2.html"><a href="exploring-data-2.html#other-control-structures"><i class="fa fa-check"></i><b>7.3</b> Other control structures</a><ul>
<li class="chapter" data-level="7.3.1" data-path="exploring-data-2.html"><a href="exploring-data-2.html#if-else-loops"><i class="fa fa-check"></i><b>7.3.1</b> if / else loops</a></li>
<li class="chapter" data-level="7.3.2" data-path="exploring-data-2.html"><a href="exploring-data-2.html#some-other-control-structures"><i class="fa fa-check"></i><b>7.3.2</b> Some other control structures</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="exploring-data-2.html"><a href="exploring-data-2.html#functions"><i class="fa fa-check"></i><b>7.4</b> Functions</a></li>
<li class="chapter" data-level="7.5" data-path="exploring-data-2.html"><a href="exploring-data-2.html#regular-expressions"><i class="fa fa-check"></i><b>7.5</b> Regular expressions</a></li>
<li class="chapter" data-level="7.6" data-path="exploring-data-2.html"><a href="exploring-data-2.html#in-course-exercise-6"><i class="fa fa-check"></i><b>7.6</b> In-course exercise</a><ul>
<li class="chapter" data-level="7.6.1" data-path="exploring-data-2.html"><a href="exploring-data-2.html#exploring-fatality-analysis-reporting-system-fars-data-1"><i class="fa fa-check"></i><b>7.6.1</b> Exploring Fatality Analysis Reporting System (FARS) data</a></li>
<li class="chapter" data-level="7.6.2" data-path="exploring-data-2.html"><a href="exploring-data-2.html#using-a-loop-to-create-state-specific-plots"><i class="fa fa-check"></i><b>7.6.2</b> Using a loop to create state-specific plots</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html"><i class="fa fa-check"></i><b>8</b> Reporting data results #2</a><ul>
<li class="chapter" data-level="8.1" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#matrices-and-lists"><i class="fa fa-check"></i><b>8.1</b> Matrices and lists</a><ul>
<li class="chapter" data-level="8.1.1" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#matrices"><i class="fa fa-check"></i><b>8.1.1</b> Matrices</a></li>
<li class="chapter" data-level="8.1.2" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#lists"><i class="fa fa-check"></i><b>8.1.2</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#apply-functions"><i class="fa fa-check"></i><b>8.2</b> <code>apply</code> functions</a></li>
<li class="chapter" data-level="8.3" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#point-maps"><i class="fa fa-check"></i><b>8.3</b> Point maps</a></li>
<li class="chapter" data-level="8.4" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#choropleth-maps"><i class="fa fa-check"></i><b>8.4</b> Choropleth maps</a></li>
<li class="chapter" data-level="8.5" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#google-maps-api"><i class="fa fa-check"></i><b>8.5</b> Google Maps API</a></li>
<li class="chapter" data-level="8.6" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#string-operations"><i class="fa fa-check"></i><b>8.6</b> String operations</a></li>
<li class="chapter" data-level="8.7" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#in-course-exercise-7"><i class="fa fa-check"></i><b>8.7</b> In-course exercise</a><ul>
<li class="chapter" data-level="8.7.1" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#writing-a-function-to-create-state-specific-plots"><i class="fa fa-check"></i><b>8.7.1</b> Writing a function to create state-specific plots</a></li>
<li class="chapter" data-level="8.7.2" data-path="reporting-data-results-2.html"><a href="reporting-data-results-2.html#first-steps-in-mapping"><i class="fa fa-check"></i><b>8.7.2</b> First steps in mapping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html"><i class="fa fa-check"></i><b>9</b> Reproducible research #2</a><ul>
<li class="chapter" data-level="9.1" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#r-notebooks"><i class="fa fa-check"></i><b>9.1</b> R Notebooks</a></li>
<li class="chapter" data-level="9.2" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#templates"><i class="fa fa-check"></i><b>9.2</b> Templates</a></li>
<li class="chapter" data-level="9.3" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#r-projects"><i class="fa fa-check"></i><b>9.3</b> R Projects</a><ul>
<li class="chapter" data-level="9.3.1" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#organization"><i class="fa fa-check"></i><b>9.3.1</b> Organization</a></li>
<li class="chapter" data-level="9.3.2" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#creating-r-projects"><i class="fa fa-check"></i><b>9.3.2</b> Creating R Projects</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#git"><i class="fa fa-check"></i><b>9.4</b> git</a><ul>
<li class="chapter" data-level="9.4.1" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#initializing-a-git-repository"><i class="fa fa-check"></i><b>9.4.1</b> Initializing a git repository</a></li>
<li class="chapter" data-level="9.4.2" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#committing"><i class="fa fa-check"></i><b>9.4.2</b> Committing</a></li>
<li class="chapter" data-level="9.4.3" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#browsing-history"><i class="fa fa-check"></i><b>9.4.3</b> Browsing history</a></li>
<li class="chapter" data-level="9.4.4" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#linking-local-repo-to-github-repo"><i class="fa fa-check"></i><b>9.4.4</b> Linking local repo to GitHub repo</a></li>
<li class="chapter" data-level="9.4.5" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#syncing-rstudio-and-github"><i class="fa fa-check"></i><b>9.4.5</b> Syncing RStudio and GitHub</a></li>
<li class="chapter" data-level="9.4.6" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#issues"><i class="fa fa-check"></i><b>9.4.6</b> Issues</a></li>
<li class="chapter" data-level="9.4.7" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#pull-request"><i class="fa fa-check"></i><b>9.4.7</b> Pull request</a></li>
<li class="chapter" data-level="9.4.8" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#merge-conflicts"><i class="fa fa-check"></i><b>9.4.8</b> Merge conflicts</a></li>
<li class="chapter" data-level="9.4.9" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#find-out-more"><i class="fa fa-check"></i><b>9.4.9</b> Find out more</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#in-course-exercise-8"><i class="fa fa-check"></i><b>9.5</b> In-course exercise</a><ul>
<li class="chapter" data-level="9.5.1" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#trying-out-templates"><i class="fa fa-check"></i><b>9.5.1</b> Trying out templates</a></li>
<li class="chapter" data-level="9.5.2" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#organizing-a-project"><i class="fa fa-check"></i><b>9.5.2</b> Organizing a project</a></li>
<li class="chapter" data-level="9.5.3" data-path="reproducible-research-2.html"><a href="reproducible-research-2.html#linking-your-project-with-a-github-repository"><i class="fa fa-check"></i><b>9.5.3</b> Linking your project with a GitHub repository</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>IV Part IV: Advanced</b></span></li>
<li class="chapter" data-level="10" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html"><i class="fa fa-check"></i><b>10</b> Entering and cleaning data #3</a><ul>
<li class="chapter" data-level="10.1" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#cleaning-very-messy-data"><i class="fa fa-check"></i><b>10.1</b> Cleaning very messy data</a><ul>
<li class="chapter" data-level="10.1.1" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#example-of-messy-data"><i class="fa fa-check"></i><b>10.1.1</b> Example of messy data</a></li>
<li class="chapter" data-level="10.1.2" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#strategy-for-messy-data"><i class="fa fa-check"></i><b>10.1.2</b> Strategy for messy data</a></li>
<li class="chapter" data-level="10.1.3" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#readlines-function"><i class="fa fa-check"></i><b>10.1.3</b> <code>readLines</code> function</a></li>
<li class="chapter" data-level="10.1.4" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#regular-expressions-for-cleaning"><i class="fa fa-check"></i><b>10.1.4</b> Regular expressions for cleaning</a></li>
<li class="chapter" data-level="10.1.5" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#working-with-lists"><i class="fa fa-check"></i><b>10.1.5</b> Working with lists</a></li>
<li class="chapter" data-level="10.1.6" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#converting-to-dataframes"><i class="fa fa-check"></i><b>10.1.6</b> Converting to dataframes</a></li>
<li class="chapter" data-level="10.1.7" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#exploring-the-hurricane-tracking-data"><i class="fa fa-check"></i><b>10.1.7</b> Exploring the hurricane tracking data</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#pulling-online-data"><i class="fa fa-check"></i><b>10.2</b> Pulling online data</a><ul>
<li class="chapter" data-level="10.2.1" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#apis"><i class="fa fa-check"></i><b>10.2.1</b> APIs</a></li>
<li class="chapter" data-level="10.2.2" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#example-riem-package"><i class="fa fa-check"></i><b>10.2.2</b> Example– <code>riem</code> package</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#example-r-api-wrappers"><i class="fa fa-check"></i><b>10.3</b> Example R API wrappers</a><ul>
<li class="chapter" data-level="10.3.1" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#ropensci"><i class="fa fa-check"></i><b>10.3.1</b> rOpenSci</a></li>
<li class="chapter" data-level="10.3.2" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#countyweather"><i class="fa fa-check"></i><b>10.3.2</b> <code>countyweather</code></a></li>
<li class="chapter" data-level="10.3.3" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#usgs-r-packages"><i class="fa fa-check"></i><b>10.3.3</b> USGS-R Packages</a></li>
<li class="chapter" data-level="10.3.4" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#u.s.-census-packages"><i class="fa fa-check"></i><b>10.3.4</b> U.S. Census packages</a></li>
<li class="chapter" data-level="10.3.5" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#other-r-api-wrappers"><i class="fa fa-check"></i><b>10.3.5</b> Other R API wrappers</a></li>
<li class="chapter" data-level="10.3.6" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#r-and-apis"><i class="fa fa-check"></i><b>10.3.6</b> R and APIs</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#parsing-webpages"><i class="fa fa-check"></i><b>10.4</b> Parsing webpages</a><ul>
<li class="chapter" data-level="10.4.1" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#rvest"><i class="fa fa-check"></i><b>10.4.1</b> <code>rvest</code></a></li>
<li class="chapter" data-level="10.4.2" data-path="entering-and-cleaning-data-3.html"><a href="entering-and-cleaning-data-3.html#scraping-multiple-pages"><i class="fa fa-check"></i><b>10.4.2</b> Scraping multiple pages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="exploring-data-3.html"><a href="exploring-data-3.html"><i class="fa fa-check"></i><b>11</b> Exploring data #3</a><ul>
<li class="chapter" data-level="11.1" data-path="exploring-data-3.html"><a href="exploring-data-3.html#forcats"><i class="fa fa-check"></i><b>11.1</b> <code>forcats</code></a></li>
<li class="chapter" data-level="11.2" data-path="exploring-data-3.html"><a href="exploring-data-3.html#simulations"><i class="fa fa-check"></i><b>11.2</b> Simulations</a><ul>
<li class="chapter" data-level="11.2.1" data-path="exploring-data-3.html"><a href="exploring-data-3.html#the-lady-tasting-tea"><i class="fa fa-check"></i><b>11.2.1</b> The lady tasting tea</a></li>
<li class="chapter" data-level="11.2.2" data-path="exploring-data-3.html"><a href="exploring-data-3.html#playing-darts"><i class="fa fa-check"></i><b>11.2.2</b> Playing darts</a></li>
<li class="chapter" data-level="11.2.3" data-path="exploring-data-3.html"><a href="exploring-data-3.html#simulations-in-research"><i class="fa fa-check"></i><b>11.2.3</b> Simulations in research</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="exploring-data-3.html"><a href="exploring-data-3.html#other-computationally-intensive-approaches"><i class="fa fa-check"></i><b>11.3</b> Other computationally-intensive approaches</a><ul>
<li class="chapter" data-level="11.3.1" data-path="exploring-data-3.html"><a href="exploring-data-3.html#bootstrap-and-friends"><i class="fa fa-check"></i><b>11.3.1</b> Bootstrap and friends</a></li>
<li class="chapter" data-level="11.3.2" data-path="exploring-data-3.html"><a href="exploring-data-3.html#bayesian-analysis"><i class="fa fa-check"></i><b>11.3.2</b> Bayesian analysis</a></li>
<li class="chapter" data-level="11.3.3" data-path="exploring-data-3.html"><a href="exploring-data-3.html#ensemble-models-and-friends"><i class="fa fa-check"></i><b>11.3.3</b> Ensemble models and friends</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html"><i class="fa fa-check"></i><b>12</b> Reporting data results #3</a><ul>
<li class="chapter" data-level="12.1" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#shiny-web-apps"><i class="fa fa-check"></i><b>12.1</b> Shiny web apps</a><ul>
<li class="chapter" data-level="12.1.1" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#resources-for-learning-shiny"><i class="fa fa-check"></i><b>12.1.1</b> Resources for learning Shiny</a></li>
<li class="chapter" data-level="12.1.2" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#basics-of-shiny-apps"><i class="fa fa-check"></i><b>12.1.2</b> Basics of Shiny apps</a></li>
<li class="chapter" data-level="12.1.3" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#server.r-file"><i class="fa fa-check"></i><b>12.1.3</b> <code>server.R</code> file</a></li>
<li class="chapter" data-level="12.1.4" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#ui.r-file"><i class="fa fa-check"></i><b>12.1.4</b> <code>ui.R</code> file</a></li>
<li class="chapter" data-level="12.1.5" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#making-a-shiny-app"><i class="fa fa-check"></i><b>12.1.5</b> Making a Shiny app</a></li>
<li class="chapter" data-level="12.1.6" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#starting-with-the-ui.r-file"><i class="fa fa-check"></i><b>12.1.6</b> Starting with the <code>ui.R</code> file</a></li>
<li class="chapter" data-level="12.1.7" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#adding-in-widgets"><i class="fa fa-check"></i><b>12.1.7</b> Adding in widgets</a></li>
<li class="chapter" data-level="12.1.8" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#creating-output-in-server.r"><i class="fa fa-check"></i><b>12.1.8</b> Creating output in <code>server.R</code></a></li>
<li class="chapter" data-level="12.1.9" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#making-the-output-reactive"><i class="fa fa-check"></i><b>12.1.9</b> Making the output reactive</a></li>
<li class="chapter" data-level="12.1.10" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#fancier-version"><i class="fa fa-check"></i><b>12.1.10</b> Fancier version</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#viridis-color-map"><i class="fa fa-check"></i><b>12.2</b> Viridis color map</a></li>
<li class="chapter" data-level="12.3" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#htmlwidgets"><i class="fa fa-check"></i><b>12.3</b> htmlWidgets</a><ul>
<li class="chapter" data-level="12.3.1" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#overview-of-htmlwidgets"><i class="fa fa-check"></i><b>12.3.1</b> Overview of htmlWidgets</a></li>
<li class="chapter" data-level="12.3.2" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#plotly-package"><i class="fa fa-check"></i><b>12.3.2</b> <code>plotly</code> package</a></li>
<li class="chapter" data-level="12.3.3" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#rbokeh-package"><i class="fa fa-check"></i><b>12.3.3</b> <code>rbokeh</code> package</a></li>
<li class="chapter" data-level="12.3.4" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#dygraphs-package"><i class="fa fa-check"></i><b>12.3.4</b> <code>dygraphs</code> package</a></li>
<li class="chapter" data-level="12.3.5" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#dt-package"><i class="fa fa-check"></i><b>12.3.5</b> <code>DT</code> package</a></li>
<li class="chapter" data-level="12.3.6" data-path="reporting-data-results-3.html"><a href="reporting-data-results-3.html#creating-your-own-widget"><i class="fa fa-check"></i><b>12.3.6</b> Creating your own widget</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="reporting-data-results-3-1.html"><a href="reporting-data-results-3-1.html"><i class="fa fa-check"></i><b>13</b> Reporting data results #3</a></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html"><i class="fa fa-check"></i><b>A</b> Appendix A: Vocabulary</a><ul>
<li class="chapter" data-level="A.1" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-1-quiz-1"><i class="fa fa-check"></i><b>A.1</b> Week 1 (Quiz 1)</a></li>
<li class="chapter" data-level="A.2" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-2-quiz-2"><i class="fa fa-check"></i><b>A.2</b> Week 2 (Quiz 2)</a></li>
<li class="chapter" data-level="A.3" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-3-quiz-3"><i class="fa fa-check"></i><b>A.3</b> Week 3 (Quiz 3)</a></li>
<li class="chapter" data-level="A.4" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-4-quiz-4"><i class="fa fa-check"></i><b>A.4</b> Week 4 (Quiz 4)</a></li>
<li class="chapter" data-level="A.5" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-5-quiz-5"><i class="fa fa-check"></i><b>A.5</b> Week 5 (Quiz 5)</a></li>
<li class="chapter" data-level="A.6" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-6-quiz-6"><i class="fa fa-check"></i><b>A.6</b> Week 6 (Quiz 6)</a></li>
<li class="chapter" data-level="A.7" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-7-quiz-7"><i class="fa fa-check"></i><b>A.7</b> Week 7 (Quiz 7)</a></li>
<li class="chapter" data-level="A.8" data-path="appendix-a-vocabulary.html"><a href="appendix-a-vocabulary.html#week-8-quiz-8"><i class="fa fa-check"></i><b>A.8</b> Week 8 (Quiz 8)</a></li>
</ul></li>
<li class="chapter" data-level="B" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html"><i class="fa fa-check"></i><b>B</b> Appendix B: Homework</a><ul>
<li class="chapter" data-level="B.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-1"><i class="fa fa-check"></i><b>B.1</b> Homework #1</a><ul>
<li class="chapter" data-level="B.1.1" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#getting-started"><i class="fa fa-check"></i><b>B.1.1</b> Getting started</a></li>
<li class="chapter" data-level="B.1.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#swirl-lessons"><i class="fa fa-check"></i><b>B.1.2</b> Swirl lessons</a></li>
<li class="chapter" data-level="B.1.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#special-swirl-commands"><i class="fa fa-check"></i><b>B.1.3</b> Special swirl commands</a></li>
</ul></li>
<li class="chapter" data-level="B.2" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-2"><i class="fa fa-check"></i><b>B.2</b> Homework #2</a></li>
<li class="chapter" data-level="B.3" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-3"><i class="fa fa-check"></i><b>B.3</b> Homework #3</a></li>
<li class="chapter" data-level="B.4" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-4"><i class="fa fa-check"></i><b>B.4</b> Homework #4</a></li>
<li class="chapter" data-level="B.5" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-5"><i class="fa fa-check"></i><b>B.5</b> Homework #5</a></li>
<li class="chapter" data-level="B.6" data-path="appendix-b-homework.html"><a href="appendix-b-homework.html#homework-6"><i class="fa fa-check"></i><b>B.6</b> Homework #6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references-1.html"><a href="references-1.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://bookdown.org" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Programming for Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="reporting-data-results-2" class="section level1">
<h1><span class="header-section-number">Chapter 8</span> Reporting data results #2</h1>
<p><a href="https://github.com/geanders/RProgrammingForResearch/raw/master/slides/CourseNotes_Week8.pdf">Download</a> a pdf of the lecture slides covering this topic.</p>
<div id="matrices-and-lists" class="section level2">
<h2><span class="header-section-number">8.1</span> Matrices and lists</h2>
<p>In this section, we’ll talk about the <code>apply</code> family of functions, which allow you to apply a function to all values in a vector, matrix, or list. </p>
<p>First, you need to know about two more object types in R:</p>
<ul>
<li><code>matrix</code></li>
<li><code>list</code></li>
</ul>
<div id="matrices" class="section level3">
<h3><span class="header-section-number">8.1.1</span> Matrices</h3>
<p>A matrix is like a data frame, but all the values in all columns must be of the same class (e.g., numeric, character).</p>
<p>R uses matrices a lot for its underlying math (e.g., for the linear algebra operations required for fitting regression models). R can do matrix operations quite quickly.</p>
<p>You can create a matrix with the <code>matrix</code> function. Input a vector with the values to fill the matrix and <code>ncol</code> to set the number of columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">5</span>)
foo</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    3    5    7    9
## [2,]    2    4    6    8   10</code></pre>
<p>By default, the matrix will fill up by column. You can fill it by row with the <code>byrow</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">ncol =</span> <span class="dv">5</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>)
foo</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5]
## [1,]    1    2    3    4    5
## [2,]    6    7    8    9   10</code></pre>
<p>In certain situations, you might want to work with a matrix instead of a data frame (for example, in cases where you were concerned about speed – a matrix is more memory efficient than the corresponding data frame). If you want to convert a data frame to a matrix, you can use the <code>as.matrix</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">col_1 =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">col_2 =</span> <span class="dv">3</span>:<span class="dv">4</span>,
                  <span class="dt">col_3 =</span> <span class="dv">5</span>:<span class="dv">6</span>, <span class="dt">col_4 =</span> <span class="dv">7</span>:<span class="dv">8</span>,
                  <span class="dt">col_5 =</span> <span class="dv">9</span>:<span class="dv">10</span>)
(foo &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(foo))</code></pre></div>
<pre><code>##      col_1 col_2 col_3 col_4 col_5
## [1,]     1     3     5     7     9
## [2,]     2     4     6     8    10</code></pre>
<p>You can index matrices with square brackets, just like data frames:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">2</span>]</code></pre></div>
<pre><code>## col_1 col_2 
##     1     3</code></pre>
<p>You cannot, however, use <code>dplyr</code> functions with matrices:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo %&gt;%<span class="st"> </span><span class="kw">filter</span>(col_1 ==<span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>Error in UseMethod(&quot;filter_&quot;) : 
  no applicable method for &#39;filter_&#39; applied to
  an object of class &quot;c(&#39;matrix&#39;, &#39;integer&#39;,
  &#39;numeric&#39;)&quot;</code></pre>
<p>All elements in a matrix must have the same class. </p>
<p>The matrix will default to make all values the most general class of any of the values, in any column. For example, if we replaced one numeric value with the character “a”, everything would turn into a character:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">foo[<span class="dv">1</span>, <span class="dv">1</span>] &lt;-<span class="st"> &quot;a&quot;</span>
foo</code></pre></div>
<pre><code>##      col_1 col_2 col_3 col_4 col_5
## [1,] &quot;a&quot;   &quot;3&quot;   &quot;5&quot;   &quot;7&quot;   &quot;9&quot;  
## [2,] &quot;2&quot;   &quot;4&quot;   &quot;6&quot;   &quot;8&quot;   &quot;10&quot;</code></pre>
</div>
<div id="lists" class="section level3">
<h3><span class="header-section-number">8.1.2</span> Lists</h3>
<p>A list has different elements, just like a data frame has different columns. However, the different elements of a list can have different lengths (unlike the columns of a data frame). The different elements can also have different classes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bar &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">some_letters =</span> letters[<span class="dv">1</span>:<span class="dv">3</span>],
            <span class="dt">some_numbers =</span> <span class="dv">1</span>:<span class="dv">5</span>, 
            <span class="dt">some_logical_values =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>))
bar</code></pre></div>
<pre><code>## $some_letters
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;
## 
## $some_numbers
## [1] 1 2 3 4 5
## 
## $some_logical_values
## [1]  TRUE FALSE</code></pre>
<p>To index an element from a list, use double square brackets. You can use bracket indexing either with numbers (which element in the list?) or with names. You can also index lists with the <code>$</code> operator.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bar[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bar[[<span class="st">&quot;some_numbers&quot;</span>]]</code></pre></div>
<pre><code>## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bar$some_logical_values</code></pre></div>
<pre><code>## [1]  TRUE FALSE</code></pre>
<p>Lists can be used to contain data with an unusual structure and / or lots of different components. For example, the information from fitting a regression is often stored as a list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_mod &lt;-<span class="st"> </span><span class="kw">glm</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>) ~<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">10</span>))
<span class="kw">is.list</span>(my_mod)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">names</span>(my_mod), <span class="dv">3</span>)</code></pre></div>
<pre><code>## [1] &quot;coefficients&quot;  &quot;residuals&quot;     &quot;fitted.values&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_mod[[<span class="st">&quot;coefficients&quot;</span>]]</code></pre></div>
<pre><code>## (Intercept)     c(1:10) 
##  0.18311575 -0.04586179</code></pre>
</div>
</div>
<div id="apply-functions" class="section level2">
<h2><span class="header-section-number">8.2</span> <code>apply</code> functions</h2>
<p>There is a whole family of <code>apply</code> functions, as part of base R. These include:</p>
<ul>
<li><code>apply</code>: Apply a function over all the rows (<code>MARGIN = 1</code>) or columns (<code>MARGIN = 2</code>) of a matrix</li>
<li><code>lapply</code>: Apply a function over elements of a list.</li>
<li><code>sapply</code>: Like <code>lapply</code>, but returns a vector instead of a list.</li>
</ul>
<p>Here is the syntax for <code>apply</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generic code
<span class="kw">apply</span>([matrix], <span class="dt">MARGIN =</span> [<span class="kw">margin</span> (<span class="dv">1</span>:<span class="st"> </span>rows, <span class="dv">2</span>:<span class="st"> </span>columns)],
      <span class="dt">FUN =</span>  [function])</code></pre></div>
<p>I’ll use the <code>worldcup</code> data as an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ex &lt;-<span class="st"> </span>worldcup[ , <span class="kw">c</span>(<span class="st">&quot;Shots&quot;</span>, <span class="st">&quot;Passes&quot;</span>, <span class="st">&quot;Tackles&quot;</span>, <span class="st">&quot;Saves&quot;</span>)]
<span class="kw">head</span>(ex)</code></pre></div>
<pre><code>##            Shots Passes Tackles Saves
## Abdoun         0      6       0     0
## Abe            0    101      14     0
## Abidal         0     91       6     0
## Abou Diaby     1    111       5     0
## Aboubakar      2     16       0     0
## Abreu          0     15       0     0</code></pre>
<p>Take the mean of all columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">apply</span>(ex, <span class="dt">MARGIN =</span> <span class="dv">2</span>, mean)</code></pre></div>
<pre><code>##      Shots     Passes    Tackles      Saves 
##  2.3042017 84.5210084  4.1915966  0.6672269</code></pre>
<p>Take the sum of all rows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">apply</span>(ex, <span class="dt">MARGIN =</span> <span class="dv">1</span>, sum), <span class="dv">4</span>)</code></pre></div>
<pre><code>##     Abdoun        Abe     Abidal Abou Diaby 
##          6        115         97        117</code></pre>
<p>You can use your own function with any of the <code>apply</code> functions. For example, if you wanted to calculate a value for each player that is a weighted mean of some of their statistics, you could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">weighted_mean &lt;-<span class="st"> </span>function(soccer_stats,
                          <span class="dt">weights =</span> <span class="kw">c</span>(<span class="fl">0.40</span>, <span class="fl">0.01</span>,
                                      <span class="fl">0.25</span>, <span class="fl">1.5</span>)){
  out &lt;-<span class="st"> </span><span class="kw">sum</span>(weights *<span class="st"> </span>soccer_stats)
  <span class="kw">return</span>(out)
}

<span class="kw">head</span>(<span class="kw">apply</span>(ex, <span class="dt">MARGIN =</span> <span class="dv">1</span>, weighted_mean), <span class="dv">4</span>)</code></pre></div>
<pre><code>##     Abdoun        Abe     Abidal Abou Diaby 
##       0.06       4.51       2.41       2.76</code></pre>
<p>The <code>lapply()</code> function will apply a function across a list. The different elements of the list do not have to be the same length (unlike a data frame, where the columns all have to have the same length).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(ex &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">a =</span> <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">5</span>), <span class="dt">b =</span> <span class="kw">rnorm</span>(<span class="dv">3</span>), <span class="dt">c =</span> letters[<span class="dv">1</span>:<span class="dv">4</span>]))</code></pre></div>
<pre><code>## $a
## [1] 1 2 3 4 5
## 
## $b
## [1]  2.3491627 -0.8387520 -0.5441897
## 
## $c
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;</code></pre>
<p>This call will calculate the mean of each function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(ex, <span class="dt">FUN =</span> mean)</code></pre></div>
<pre><code>## $a
## [1] 3
## 
## $b
## [1] 0.3220737
## 
## $c
## [1] NA</code></pre>
<p>You can include arguments for the function that you specify with <code>FUN</code>, and they’ll be passed to that function. For example, to get the first value of each element, you can run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">lapply</span>(ex, <span class="dt">FUN =</span> head, <span class="dt">n =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## $a
## [1] 1
## 
## $b
## [1] 2.349163
## 
## $c
## [1] &quot;a&quot;</code></pre>
<p>The <code>sapply()</code> function also applies a function over a list, but it returns a vector rather than a list:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sapply</span>(ex, <span class="dt">FUN =</span> head, <span class="dt">n =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##                  a                  b                  c 
##                &quot;1&quot; &quot;2.34916270287454&quot;                &quot;a&quot;</code></pre>
<p>In practice, I do use <code>apply()</code> some, but I can often find a way to do similar things to other <code>apply</code> family functions using the tools in <code>dplyr</code>. </p>
<p>You should know that <code>apply</code> family functions take advantage of the matrix structure in R. This can be one of the fastest ways to run code in R. It is usually a lot faster than doing the same things with loops. However, unless you are working with large data sets, you may not notice a difference, and “tidyverse” functions are usually comparable in speed. </p>
<p>I would recommend using whichever method makes the most sense to you until you run into an analysis that takes a noticeable amount of time to run, and then you might want to work a bit more to optimize your code. </p>
</div>
<div id="point-maps" class="section level2">
<h2><span class="header-section-number">8.3</span> Point maps</h2>
<p>It is very easy now to create point maps in R based on longitude and latitude values of specific locations. You can use the <code>map_data</code> function from the <code>ggplot2</code> package to pull data for maps at different levels (“usa”, “state”, “world”, “county”).</p>
<p>The maps you pull using <code>map_data</code> are just data to use to plot polygon shapes for areas like states and counties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
us_map &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;state&quot;</span>)
<span class="kw">head</span>(us_map, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        long      lat group order  region subregion
## 1 -87.46201 30.38968     1     1 alabama      &lt;NA&gt;
## 2 -87.48493 30.37249     1     2 alabama      &lt;NA&gt;
## 3 -87.52503 30.37249     1     3 alabama      &lt;NA&gt;</code></pre>
<p>You can add points to these based on latitude and longitude.</p>
<p>Mapping uses the <code>long</code> and <code>lat</code> columns from this data for location:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">north_carolina &lt;-<span class="st"> </span>us_map %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(region ==<span class="st"> &quot;north carolina&quot;</span>)
<span class="kw">ggplot</span>(north_carolina, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat)) +
<span class="st">  </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cav-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>If you try to plot lines, however, you’ll have a problem:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">carolinas &lt;-<span class="st"> </span>us_map %&gt;%<span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="kw">str_detect</span>(region, <span class="st">&quot;carolina&quot;</span>))
<span class="kw">ggplot</span>(carolinas, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/caw-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>The <code>group</code> column fixes this problem. It will plot a separate path or polygon for each separate group. For mapping, this gives separate groupings for mainland versus islands and for different states:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">carolinas %&gt;%
<span class="st">  </span><span class="kw">group_by</span>(group) %&gt;%
<span class="st">  </span><span class="kw">slice</span>(<span class="dv">1</span>)</code></pre></div>
<pre><code>## Source: local data frame [4 x 6]
## Groups: group [4]
## 
##        long      lat group order         region subregion
##       &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;          &lt;chr&gt;     &lt;chr&gt;
## 1 -75.89399 36.55471    38  9549 north carolina    knotts
## 2 -78.55824 33.86753    39  9587 north carolina      main
## 3 -76.00285 36.55471    40 10321 north carolina      spit
## 4 -83.10753 34.99053    47 11441 south carolina      &lt;NA&gt;</code></pre>
<p>Using <code>group = group</code> avoids the extra lines from the earlier map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(carolinas, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat,
                      <span class="dt">group =</span> group)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_path</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cay-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>To plot filled regions, use <code>geom_polygon</code> with <code>fill = region</code>. Also, the “void” theme is often useful when mapping:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(carolinas, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat,
                      <span class="dt">group =</span> group,
                      <span class="dt">fill =</span> region)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">theme_void</span>()</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/caz-1.png" width="432" style="display: block; margin: auto;" /></p>
<p>Here is an example of plotting all of the US by state:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(us_map, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat,
                            <span class="dt">group =</span> group)) +<span class="st"> </span>
<span class="st">        </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;dodgerblue&quot;</span>,
                     <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) +
<span class="st">        </span><span class="kw">theme_void</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_1</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbb-1.png" width="624" style="display: block; margin: auto;" /></p>
<p>To add points to these maps, you can use <code>geom_point</code>, again using longitude and latitude to define position. </p>
<p>Here I’ll use an example of data points related to the story told in last year’s <a href="http://serialpodcast.org">“Serial” podcast</a>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">serial &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/serial_map_data.csv&quot;</span>)
<span class="kw">head</span>(serial, <span class="dv">3</span>)</code></pre></div>
<pre><code>##     x   y      Type Name Description
## 1 356 437 cell-site L688            
## 2 740 360 cell-site L698            
## 3 910 340 cell-site L654</code></pre>
<p><a href="https://github.com/dgrtwo/serial-ggvis/blob/master/serial-preprocessing.Rmd">David Robinson</a> figured out a way to convert the x and y coordinates in this data to latitude and longitude coordinates. I’m also adding a column for whether of not the point is a cell tower.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">serial &lt;-<span class="st"> </span>serial %&gt;%
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">long =</span> -<span class="fl">76.8854</span> +<span class="st"> </span><span class="fl">0.00017022</span> *<span class="st"> </span>x,
           <span class="dt">lat  =</span> <span class="fl">39.23822</span> +<span class="st"> </span><span class="fl">1.371014e-04</span> *<span class="st"> </span>y,
           <span class="dt">tower =</span> Type ==<span class="st"> &quot;cell-site&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">serial[<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">2</span>, (<span class="kw">nrow</span>(serial) -<span class="st"> </span><span class="dv">1</span>):<span class="kw">nrow</span>(serial)), 
       <span class="kw">c</span>(<span class="st">&quot;Type&quot;</span>, <span class="st">&quot;Name&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;lat&quot;</span>, <span class="st">&quot;tower&quot;</span>)]</code></pre></div>
<pre><code>##             Type          Name      long      lat tower
## 1      cell-site          L688 -76.82480 39.29813  TRUE
## 2      cell-site          L698 -76.75944 39.28758  TRUE
## 24 base-location Adnan&#39;s house -76.76284 39.30622 FALSE
## 25 base-location  Jenn&#39;s house -76.72301 39.29443 FALSE</code></pre>
<p>Now I can map just Baltimore City and Baltimore County in Maryland and add these points. I used <code>map_data</code> to pull the “county” map and specified “region” as “maryland”, to limit the map just to Maryland counties.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">baltimore &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&#39;county&#39;</span>, <span class="dt">region =</span> <span class="st">&#39;maryland&#39;</span>)
<span class="kw">head</span>(baltimore, <span class="dv">3</span>)</code></pre></div>
<pre><code>##        long      lat group order   region subregion
## 1 -78.64992 39.53982     1     1 maryland  allegany
## 2 -78.70148 39.55128     1     2 maryland  allegany
## 3 -78.74159 39.57420     1     3 maryland  allegany</code></pre>
<p>From that, I subset out rows where the <code>subregion</code> column was “baltimore city” or “baltimore”.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">baltimore &lt;-<span class="st"> </span><span class="kw">subset</span>(baltimore, 
                    subregion %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;baltimore city&quot;</span>,
                                     <span class="st">&quot;baltimore&quot;</span>))
<span class="kw">head</span>(baltimore, <span class="dv">3</span>)</code></pre></div>
<pre><code>##          long      lat group order   region subregion
## 114 -76.88521 39.35074     3   114 maryland baltimore
## 115 -76.89094 39.37939     3   115 maryland baltimore
## 116 -76.88521 39.40804     3   116 maryland baltimore</code></pre>
<p>I used <code>geom_point</code> to plot the points. <code>ggplot</code> uses the <code>group</code> column to group together counties, but we don’t need that in the points, so I needed to set <code>group = NA</code> in the <code>geom_point</code> statement. I put <code>color = tower</code> inside the <code>aes</code> statement so that the points would be one color for cell towers and another color for everything else.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">balt_plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(baltimore, 
                    <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group)) +<span class="st"> </span>
<span class="st">        </span><span class="kw">geom_polygon</span>(<span class="dt">fill =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> serial, <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat,
                                      <span class="dt">group =</span> <span class="ot">NA</span>,
                                      <span class="dt">color =</span> tower)) +<span class="st"> </span>
<span class="st">        </span><span class="kw">theme_bw</span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">balt_plot</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbi-1.png" width="672" /></p>
</div>
<div id="choropleth-maps" class="section level2">
<h2><span class="header-section-number">8.4</span> Choropleth maps</h2>
<p>There’s a fantastic new(-ish) package in R to plot choropleth maps. You could also plot choropleths using <code>ggplot</code> and other mapping functions, but I would strongly recommend this new package if you’re mapping the US.</p>
<p>You will need to install and load the <code>choroplethr</code> package in R to use the functions below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># install.packages(&quot;choroplethr&quot;)</span>
<span class="kw">library</span>(choroplethr)

<span class="co"># install.packages(&quot;choroplethrMaps&quot;)</span>
<span class="kw">library</span>(choroplethrMaps)</code></pre></div>
<p>At the most basic level, you can use this package to plot some data that comes automatically with the package (you’ll just need to load the data using the <code>data</code> function). For example, if you wanted to plot state-by-state populations as of 2012, you could use:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(df_pop_state)
map_3 &lt;-<span class="st"> </span><span class="kw">state_choropleth</span>(df_pop_state)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_3</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbl-1.png" width="768" /></p>
<p>You can find out more about the <code>df_pop_state</code> data if you type <code>?df_pop_state</code>. Notice that, for the data frame, the location is given in a column called <code>region</code> and the population size to plot is in a column called <code>value</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(df_pop_state, <span class="dv">3</span>)</code></pre></div>
<pre><code>##    region   value
## 1 alabama 4777326
## 2  alaska  711139
## 3 arizona 6410979</code></pre>
<p>You could use this function to create any state-level choropleth you wanted, as long as you could create a data frame with a column for states called <code>region</code> and a column with the value you want to show called <code>value</code>.</p>
<p>You can run similar functions at different spatial resolutions (for example, county or zip code):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(df_pop_county)
<span class="kw">head</span>(df_pop_county, <span class="dv">3</span>)</code></pre></div>
<pre><code>##   region  value
## 1   1001  54590
## 2   1003 183226
## 3   1005  27469</code></pre>
<p>You can plot choropleths at this level, as well:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_4 &lt;-<span class="st"> </span><span class="kw">county_choropleth</span>(df_pop_county)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_4</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbp-1.png" width="768" /></p>
<p>You can even do this for countries of the world:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(df_pop_country)
<span class="kw">country_choropleth</span>(df_pop_country)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbq-1.png" width="768" /></p>
<p>You can zoom into states or counties. For example, to plot population by county in Colorado, you could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">county_choropleth</span>(df_pop_county, <span class="dt">state_zoom =</span> <span class="st">&quot;colorado&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cbr-1.png" width="576" /></p>
<p>You can also use this package to map different tables from the US Census’ American Community Survey.</p>
<p>The package includes the <code>choroplethr_acs()</code> function to do this, with an option for which level of map you want (<code>map =</code>, choices are “state”, “country”, and “zip”). If you want to map at the state level, for example, use <code>state_choroplethr_acs()</code> (other options are county level and zip code level).</p>
<p>These functions pull recent Census data directly from the US Census using its API, so they require you to get an API key, which you can get <a href="http://api.census.gov/data/key_signup.html">here</a>. </p>
<p>Once you put in your request, they’ll email you your key. Once they give you your API key, you’ll need to install it on R:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(acs)
<span class="kw">api.key.install</span>(<span class="st">&#39;[your census api key]&#39;</span>);</code></pre></div>
<p>You can pick from a large number of American Community Survey tables– <a href="http://factfinder.census.gov/faces/affhelp/jsf/pages/metadata.xhtml?lang=en&amp;type=dataset&amp;id=dataset.en.ACS_12_5YR">see here</a> for the list plus ID numbers. If the table has multiple columns, you will be prompted to select which one you want to plot.</p>
<p>For example, table B19301 gives per-capita income, so if you wanted to plot that, you could run:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">county_choropleth_acs</span>(<span class="dt">tableId =</span> <span class="st">&quot;B19301&quot;</span>,
                       <span class="dt">state_zoom =</span> <span class="kw">c</span>(<span class="st">&quot;wyoming&quot;</span>,
                                      <span class="st">&quot;colorado&quot;</span>))</code></pre></div>
</div>
<div id="google-maps-api" class="section level2">
<h2><span class="header-section-number">8.5</span> Google Maps API</h2>
<p>The <code>ggmap</code> package allows you to use tools from Google Maps directly from R.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## install.packages(&quot;ggmap&quot;)
<span class="kw">library</span>(ggmap)</code></pre></div>
<p>This package uses the Google Maps API, so you should read their <a href="http://developers.google.com/maps/terms">terms of service</a> and make sure you follow them. In particular, you are limited to just a certain number of queries per time.</p>
<p>You can use the <code>get_map</code> function to get maps for different locations. You can either use the longitude and latitude of the center point of the map, along with the <code>zoom</code> option to say how much to zoom in (3: continent to 20: building) or you can use a character string to specify a location.</p>
<p>If you do the second, <code>get_map</code> will actually use the Google Maps API to geocode the string to a latitude and longitude and then get the map (you can imagine that this is like searching in Google Maps in the search box for a location).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beijing &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Beijing&quot;</span>, <span class="dt">zoom =</span> <span class="dv">12</span>)
<span class="kw">ggmap</span>(beijing)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cby-1.png" width="336" style="display: block; margin: auto;" /></p>
<p>With this package, you can get maps from the following different sources:</p>
<ul>
<li>Google Maps</li>
<li>OpenStreetMap</li>
<li>Stamen Maps</li>
<li>CloudMade Maps (You may need a separate API key for this)</li>
</ul>
<p>Here are different examples of Beijing using different map sources. (Also, note that I’m using the option <code>extent = &quot;device&quot;</code> to fill up the whole plot are with the map, instead of including axis labels and titles.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">beijing_a &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Beijing&quot;</span>, <span class="dt">zoom =</span> <span class="dv">12</span>,
                     <span class="dt">source =</span> <span class="st">&quot;stamen&quot;</span>, <span class="dt">maptype =</span> <span class="st">&quot;toner&quot;</span>)
a &lt;-<span class="st"> </span><span class="kw">ggmap</span>(beijing_a, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>)

beijing_b &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Beijing&quot;</span>, <span class="dt">zoom =</span> <span class="dv">12</span>,
                     <span class="dt">source =</span> <span class="st">&quot;stamen&quot;</span>, <span class="dt">maptype =</span> <span class="st">&quot;watercolor&quot;</span>)
b &lt;-<span class="st"> </span><span class="kw">ggmap</span>(beijing_b, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>)

beijing_c &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="st">&quot;Beijing&quot;</span>, <span class="dt">zoom =</span> <span class="dv">12</span>,
                     <span class="dt">source =</span> <span class="st">&quot;google&quot;</span>, <span class="dt">maptype =</span> <span class="st">&quot;hybrid&quot;</span>)
c &lt;-<span class="st"> </span><span class="kw">ggmap</span>(beijing_c, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">grid.arrange</span>(a, b, c, <span class="dt">nrow =</span> <span class="dv">1</span>) </code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccb-1.png" width="672" /></p>
<p>As with the maps from <code>ggplot2</code>, you can add points to these maps:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">serial_phone &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data/serial_phone_data.csv&quot;</span>) %&gt;%<span class="st"> </span>
<span class="st">        </span><span class="kw">mutate</span>(<span class="dt">Cell_Site =</span> <span class="kw">substring</span>(Cell_Site, <span class="dv">1</span>, <span class="dv">4</span>),
               <span class="dt">Call_Time =</span> <span class="kw">as.POSIXct</span>(Call_Time, <span class="dt">format =</span> <span class="st">&quot;%d/%m/%y %H:%M&quot;</span>,
                                      <span class="dt">tz =</span> <span class="st">&quot;EST&quot;</span>)) %&gt;%
<span class="st">        </span><span class="kw">left_join</span>(serial, <span class="dt">by =</span> <span class="kw">c</span>(<span class="st">&quot;Cell_Site&quot;</span> =<span class="st"> &quot;Name&quot;</span>)) %&gt;%
<span class="st">        </span><span class="kw">select</span>(Person_Called, Call_Time, Duration, long, lat) %&gt;%
<span class="st">        </span><span class="kw">filter</span>(!(Person_Called %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;incoming&quot;</span>, <span class="st">&quot;# + Adnan cell&quot;</span>))) %&gt;%
<span class="st">        </span><span class="kw">arrange</span>(Call_Time)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">serial_map &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="kw">c</span>(-<span class="fl">76.7</span>, <span class="fl">39.3</span>), <span class="dt">zoom =</span> <span class="dv">12</span>,
                      <span class="dt">source =</span> <span class="st">&quot;stamen&quot;</span>,
                      <span class="dt">maptype =</span> <span class="st">&quot;toner&quot;</span>)
serial_map &lt;-<span class="st"> </span><span class="kw">ggmap</span>(serial_map, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>) +<span class="st"> </span>
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> serial_phone,
                   <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat),
                   <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>,
                   <span class="dt">alpha =</span> <span class="fl">0.4</span>) +
<span class="st">        </span><span class="kw">geom_point</span>(<span class="dt">data =</span> <span class="kw">subset</span>(serial,
                                 Type !=<span class="st"> &quot;cell-site&quot;</span>),
                   <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat),
                   <span class="dt">color =</span> <span class="st">&quot;darkgoldenrod1&quot;</span>,
                   <span class="dt">size =</span> <span class="dv">2</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccg-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>You can also use the Google Maps API, through the <code>geocode</code> function, to get the latitude and longitude of specific locations. Basically, if the string would give you the right location if you typed it in Google Maps, <code>geocode</code> should be able to geocode it.</p>
<p>For example, you can get the location of CSU:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">geocode</span>(<span class="st">&quot;Colorado State University&quot;</span>)</code></pre></div>
<pre><code>##   lon lat
## 1  NA  NA</code></pre>
<p>You can also get a location by address:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">geocode</span>(<span class="st">&quot;1 First St NE, Washington, DC&quot;</span>)</code></pre></div>
<pre><code>##         lon      lat
## 1 -77.00465 38.89051</code></pre>
<p>You can get distances, too, using the <code>mapdist</code> function with two locations. This will give you distance and also time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mapdist</span>(<span class="st">&quot;Fort Collins CO&quot;</span>,
        <span class="st">&quot;1 First St NE, Washington, DC&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">select</span>(from, miles, hours)</code></pre></div>
<pre><code>##              from    miles    hours
## 1 Fort Collins CO 1670.754 24.62389</code></pre>
</div>
<div id="string-operations" class="section level2">
<h2><span class="header-section-number">8.6</span> String operations</h2>
<p>The <code>str_trim</code> function from the <code>stringr</code> package allows you to trim leading and trailing white space:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">with_spaces &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;    a &quot;</span>, <span class="st">&quot;  bob&quot;</span>, <span class="st">&quot; gamma&quot;</span>)
with_spaces</code></pre></div>
<pre><code>## [1] &quot;    a &quot; &quot;  bob&quot;  &quot; gamma&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str_trim</span>(with_spaces)</code></pre></div>
<pre><code>## [1] &quot;a&quot;     &quot;bob&quot;   &quot;gamma&quot;</code></pre>
<p>This is rarer, but if you ever want to, you can add leading and/or trailing white space to elements of a character vector with <code>str_pad</code> from the <code>stringr</code> package.</p>
<p>There are also functions to change a full character string to uppercase, lowercase, or title case:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">titanic_train$Name[<span class="dv">1</span>]</code></pre></div>
<pre><code>## [1] &quot;Braund, Mr. Owen Harris&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str_to_upper</span>(titanic_train$Name[<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] &quot;BRAUND, MR. OWEN HARRIS&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str_to_lower</span>(titanic_train$Name[<span class="dv">1</span>])</code></pre></div>
<pre><code>## [1] &quot;braund, mr. owen harris&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str_to_title</span>(<span class="kw">str_to_lower</span>(titanic_train$Name[<span class="dv">1</span>]))</code></pre></div>
<pre><code>## [1] &quot;Braund, Mr. Owen Harris&quot;</code></pre>
</div>
<div id="in-course-exercise-7" class="section level2">
<h2><span class="header-section-number">8.7</span> In-course exercise</h2>
<p>This exercise will continue using the Fatality Analysis Reporting System (FARS) data we started using last week.</p>
<div id="writing-a-function-to-create-state-specific-plots" class="section level3">
<h3><span class="header-section-number">8.7.1</span> Writing a function to create state-specific plots</h3>
<ul>
<li>Adapt the code that you wrote for to create a loop in last week’s in-course exercise and write a function that will create a state-specific plot when you call it. This function should have inputs of <code>datafr</code> and <code>which_state</code>, where <code>datafr</code> is the data frame with the full data set (<code>accident</code> in this case) and <code>which_state</code> is the name of the state for which you’d like to create the plot. Name your functions <code>make_state_plot</code>. Here are a few examples of running this function:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make_state_plot</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;California&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cco-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make_state_plot</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;North Carolina&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cco-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">make_state_plot</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;Illinois&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cco-3.png" width="576" style="display: block; margin: auto;" /></p>
<ul>
<li>In general, there is a pattern of more fatal accidents during the daytime being unrelated to drunk driving versus related. The pattern is reversed for nighttime accidents. Use your function to see if you can find any states that don’t follow this pattern.</li>
<li>So far, we have not covered error checking in functions. In the function that you just wrote, we are assuming that the user will never give inputs that would cause errors. Look through the code for your function and see what assumptions we’re making about what values a user would input for <code>datafr</code> and <code>which_state</code>. What could go wrong if a user does not comply with these assumptions?</li>
<li>The best practice when writing functions, especially for others to use, is to use the package::function syntax to identify which package each function comes from. For example, if you’re using <code>mutate</code> in a function, you should write the function code as <code>dplyr::mutate</code>. Go back through the code for the function you wrote. Every time it uses a function that is not part of base R, change the code to use this package::function syntax.</li>
<li>If you have time: Can you combine your function, a loop (or <code>lapply</code>), and regular expressions to create plots for all states that start with “C”? That have “North” in their names? (<em>Hint</em>: One way to get a list of states is from the <code>accident</code> data frame. Once you’ve joined in state names as a column called <code>state_name</code>, you can use: <code>unique(accident$state_name)</code>.)</li>
</ul>
<div id="example-r-code-12" class="section level4">
<h4><span class="header-section-number">8.7.1.1</span> Example R code</h4>
<p>Here is some example R code for writing the function to create state-specific plots:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">make_state_plot &lt;-<span class="st"> </span>function(datafr, which_state){
  a &lt;-<span class="st"> </span>datafr %&gt;%
<span class="st">    </span>dplyr::<span class="kw">filter</span>(state_name ==<span class="st"> </span>which_state) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">mutate</span>(<span class="dt">drunk_dr =</span> <span class="kw">factor</span>(drunk_dr,
                             <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Unrelated to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>,
                                        <span class="st">&quot;Related to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>)),
           <span class="dt">daytime =</span> <span class="kw">factor</span>(daytime, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Nighttime&quot;</span>, <span class="st">&quot;Daytime&quot;</span>))) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">group_by</span>(daytime, month, drunk_dr) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">summarize_</span>(<span class="dt">accidents =</span> ~<span class="st"> </span><span class="kw">n</span>()) %&gt;%
<span class="st">    </span>ggplot2::<span class="kw">ggplot</span>(ggplot2::<span class="kw">aes</span>(<span class="dt">x =</span> daytime, <span class="dt">y =</span> accidents,
                                 <span class="dt">group =</span> daytime)) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">facet_wrap</span>(~<span class="st"> </span>drunk_dr, <span class="dt">ncol =</span> <span class="dv">2</span>) +
<span class="st">    </span>ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Time of day&quot;</span>) +<span class="st"> </span>ggplot2::<span class="kw">ylab</span>(<span class="st">&quot;# of monthly accidents&quot;</span>) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;Fatal accidents in&quot;</span>, which_state, <span class="st">&quot;in 2015&quot;</span>))
  <span class="kw">return</span>(a)
}

<span class="co"># With package::function notation</span>
make_state_plot &lt;-<span class="st"> </span>function(datafr, which_state){
  a &lt;-<span class="st"> </span>datafr %&gt;%
<span class="st">    </span>dplyr::<span class="kw">filter</span>(state_name ==<span class="st"> </span>which_state) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">mutate</span>(<span class="dt">drunk_dr =</span> <span class="kw">factor</span>(drunk_dr,
                             <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Unrelated to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>,
                                        <span class="st">&quot;Related to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>)),
           <span class="dt">daytime =</span> <span class="kw">factor</span>(daytime, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Nighttime&quot;</span>, <span class="st">&quot;Daytime&quot;</span>))) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">group_by</span>(daytime, month, drunk_dr) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">summarize_</span>(<span class="dt">accidents =</span> ~<span class="st"> </span><span class="kw">n</span>()) %&gt;%
<span class="st">    </span>ggplot2::<span class="kw">ggplot</span>(ggplot2::<span class="kw">aes</span>(<span class="dt">x =</span> daytime, <span class="dt">y =</span> accidents,
                                 <span class="dt">group =</span> daytime)) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">facet_wrap</span>(~<span class="st"> </span>drunk_dr, <span class="dt">ncol =</span> <span class="dv">2</span>) +
<span class="st">    </span>ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Time of day&quot;</span>) +<span class="st"> </span>ggplot2::<span class="kw">ylab</span>(<span class="st">&quot;# of monthly accidents&quot;</span>) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;Fatal accidents in&quot;</span>, which_state, <span class="st">&quot;in 2015&quot;</span>))
  <span class="kw">return</span>(a)
}</code></pre></div>
<p>Example of using this function to create plots for all states that start with “C”:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">states &lt;-<span class="st"> </span><span class="kw">unique</span>(accident$state_name)
c_states &lt;-<span class="st"> </span>states[<span class="kw">str_detect</span>(states, <span class="st">&quot;^C&quot;</span>)]

for(state in c_states){
  state_plot &lt;-<span class="st"> </span><span class="kw">make_state_plot</span>(<span class="dt">datafr =</span> accident,
                                <span class="dt">which_state =</span> state)
  <span class="kw">print</span>(state_plot)
}</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccq-1.png" width="576" style="display: block; margin: auto;" /><img src="RProgrammingForResearch_files/figure-html/ccq-2.png" width="576" style="display: block; margin: auto;" /><img src="RProgrammingForResearch_files/figure-html/ccq-3.png" width="576" style="display: block; margin: auto;" /></p>
<p>To use <code>lapply</code>, the state name needs to be the first argument in the function. We could re-write the function to comply and then use <code>lapply</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">make_state_plot &lt;-<span class="st"> </span>function(which_state, datafr){
  a &lt;-<span class="st"> </span>datafr %&gt;%
<span class="st">    </span>dplyr::<span class="kw">filter</span>(state_name ==<span class="st"> </span>which_state) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">mutate</span>(<span class="dt">drunk_dr =</span> <span class="kw">factor</span>(drunk_dr,
                             <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Unrelated to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>,
                                        <span class="st">&quot;Related to</span><span class="ch">\n</span><span class="st">drunk driving&quot;</span>)),
           <span class="dt">daytime =</span> <span class="kw">factor</span>(daytime, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Nighttime&quot;</span>, <span class="st">&quot;Daytime&quot;</span>))) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">group_by</span>(daytime, month, drunk_dr) %&gt;%
<span class="st">    </span>dplyr::<span class="kw">summarize_</span>(<span class="dt">accidents =</span> ~<span class="st"> </span><span class="kw">n</span>()) %&gt;%
<span class="st">    </span>ggplot2::<span class="kw">ggplot</span>(ggplot2::<span class="kw">aes</span>(<span class="dt">x =</span> daytime, <span class="dt">y =</span> accidents,
                                 <span class="dt">group =</span> daytime)) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">geom_boxplot</span>() +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">facet_wrap</span>(~<span class="st"> </span>drunk_dr, <span class="dt">ncol =</span> <span class="dv">2</span>) +
<span class="st">    </span>ggplot2::<span class="kw">xlab</span>(<span class="st">&quot;Time of day&quot;</span>) +<span class="st"> </span>ggplot2::<span class="kw">ylab</span>(<span class="st">&quot;# of monthly accidents&quot;</span>) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">ggtitle</span>(<span class="kw">paste</span>(<span class="st">&quot;Fatal accidents in&quot;</span>, which_state, <span class="st">&quot;in 2015&quot;</span>))
  <span class="kw">return</span>(a)
}

north_states &lt;-<span class="st"> </span>states[<span class="kw">str_detect</span>(states, <span class="st">&quot;North&quot;</span>)]
<span class="kw">lapply</span>(north_states, make_state_plot, <span class="dt">datafr =</span> accident)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccr-1.png" width="576" style="display: block; margin: auto;" /><img src="RProgrammingForResearch_files/figure-html/ccr-2.png" width="576" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="first-steps-in-mapping" class="section level3">
<h3><span class="header-section-number">8.7.2</span> First steps in mapping</h3>
<p>If you have time, you can try some exercises with mapping.</p>
<ul>
<li>Read in and clean up the FARS data and save it to an R object called <code>accident</code>. The <code>accident</code> data frame should include location (longitude and latitude), state, and whether the accident involved drunk driving. Once you’re done cleaning, the dataset should look like this:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state_fips &lt;-<span class="st"> </span><span class="kw">read_delim</span>(<span class="st">&quot;http://www2.census.gov/geo/docs/reference/state.txt&quot;</span>,
                         <span class="dt">delim =</span> <span class="st">&quot;|&quot;</span>) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">rename</span>(<span class="dt">state =</span> STATE,
                <span class="dt">state_name =</span> STATE_NAME) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(state, state_name) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">mutate</span>(<span class="dt">state =</span> <span class="kw">as.integer</span>(state))

accident &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/accident.csv&quot;</span>) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(STATE, LATITUDE, LONGITUD, DRUNK_DR) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">rename</span>(<span class="dt">state =</span> STATE,
                <span class="dt">lat =</span> LATITUDE,
                <span class="dt">long =</span> LONGITUD,
                <span class="dt">drunk_dr =</span> DRUNK_DR) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">mutate</span>(<span class="dt">drunk_dr =</span> drunk_dr &gt;<span class="st"> </span><span class="dv">0</span>) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">left_join</span>(state_fips, <span class="dt">by =</span> <span class="st">&quot;state&quot;</span>) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">select</span>(-state)
accident %&gt;%<span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 5 × 4
##        lat      long drunk_dr state_name
##      &lt;dbl&gt;     &lt;dbl&gt;    &lt;lgl&gt;      &lt;chr&gt;
## 1 33.87865 -87.32533     TRUE    Alabama
## 2 34.91044 -86.90871    FALSE    Alabama
## 3 32.14201 -85.75846     TRUE    Alabama
## 4 31.43981 -85.51030     TRUE    Alabama
## 5 31.31933 -85.51510    FALSE    Alabama</code></pre>
<ul>
<li>Next, create another R object with state-specific summaries. This object should be a data frame called <code>state_summaries</code> that gives the total number of fatal accidents in each state and the percent of all fatal accidents related to drunk driving in each state. The <code>state_summaries</code> data frame should look like this when you are done cleaning:</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state_summaries &lt;-<span class="st"> </span>accident %&gt;%
<span class="st">  </span>dplyr::<span class="kw">group_by</span>(state_name) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">summarize_</span>(<span class="dt">n =</span> ~<span class="st"> </span><span class="kw">n</span>(),
            <span class="dt">perc_drunk_dr =</span> ~<span class="st"> </span><span class="dv">100</span> *<span class="st"> </span><span class="kw">mean</span>(drunk_dr)) <span class="co"># Because `drunk_dr` is </span>
                                            <span class="co"># 0 / 1, the mean is the percent of </span>
                                            <span class="co"># values where `drunk_dr` == 1.</span>
state_summaries %&gt;%<span class="st"> </span><span class="kw">slice</span>(<span class="dv">1</span>:<span class="dv">5</span>)</code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   state_name     n perc_drunk_dr
##        &lt;chr&gt; &lt;int&gt;         &lt;dbl&gt;
## 1    Alabama   783      27.45849
## 2     Alaska    60      40.00000
## 3    Arizona   810      28.76543
## 4   Arkansas   472      25.84746
## 5 California  2925      24.54701</code></pre>
<ul>
<li>Create the following state-level choropleths of number of fatal accidents in 2015 in each state and of the percent of fatal accidents linked to drunk driving in each state. The quickest way to do this is with the <code>choroplethr</code> package.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># With `choroplethr` package</span>
<span class="kw">library</span>(choroplethr)
state_summaries %&gt;%
<span class="st">  </span>dplyr::<span class="kw">mutate</span>(<span class="dt">state_name =</span> <span class="kw">str_to_lower</span>(state_name)) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">rename</span>(<span class="dt">region =</span> state_name,
                <span class="dt">value =</span> n) %&gt;%
<span class="st">  </span><span class="kw">state_choropleth</span>(<span class="dt">title =</span> <span class="st">&quot;Fatal accidents by state, 2015&quot;</span>,
                   <span class="dt">legend =</span> <span class="st">&quot;# of fatal accidents&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccu-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">state_summaries %&gt;%
<span class="st">  </span>dplyr::<span class="kw">mutate</span>(<span class="dt">state_name =</span> <span class="kw">str_to_lower</span>(state_name)) %&gt;%
<span class="st">  </span>dplyr::<span class="kw">rename</span>(<span class="dt">region =</span> state_name,
                <span class="dt">value =</span> perc_drunk_dr) %&gt;%
<span class="st">  </span><span class="kw">state_choropleth</span>(<span class="dt">title =</span> <span class="st">&quot;Percent of fatal accidents linked</span><span class="ch">\n</span><span class="st">to drunk driving, 2015&quot;</span>,
                   <span class="dt">legend =</span> <span class="st">&quot;% of fatal accidents</span><span class="ch">\n</span><span class="st">linked to drunk driving&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccu-2.png" width="672" /></p>
<ul>
<li>Now, you will be using the latitude and longitude of each accident to plot accident locations within a state. Check if the columns for latitude and longitude need more cleaning (spoiler alert— they do). Filter out any values that could not reasonably be within the 50 U.S. states and D.C.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># It turns out that values like 77.7777, 88.8888, and 99.9999 are used as </span>
<span class="co"># missing values of latitude (similar for 777.777, etc., for longitude)</span>
accident &lt;-<span class="st"> </span>accident %&gt;%
<span class="st">  </span>dplyr::<span class="kw">filter</span>(lat &lt;<span class="st"> </span><span class="dv">75</span> &amp;<span class="st"> </span>long &lt;<span class="st"> </span><span class="dv">777</span>)</code></pre></div>
<ul>
<li>Map the locations of fatal accidents in Texas in 2015 on top of a Google Map base map that shows major roads. An example map is shown below. (<em>Hint:</em> Use the <code>get_map</code> and <code>ggmap</code> functions for this part.)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">texas &lt;-<span class="st"> </span><span class="kw">get_map</span>(<span class="dt">location =</span> <span class="st">&quot;texas&quot;</span>, <span class="dt">zoom =</span> <span class="dv">6</span>, <span class="dt">maptype =</span> <span class="st">&quot;roadmap&quot;</span>)
<span class="kw">ggmap</span>(texas, <span class="dt">extent =</span> <span class="st">&quot;device&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">data =</span> dplyr::<span class="kw">filter</span>(accident, state_name ==<span class="st"> &quot;Texas&quot;</span>), 
             <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat), <span class="dt">alpha =</span> <span class="fl">0.2</span>, <span class="dt">size =</span> <span class="fl">0.5</span>,
             <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccw-1.png" width="672" /></p>
<ul>
<li>Create a function that will take three inputs: <code>datafr</code>, a data frame like <code>accident</code> with fatal accident data; <code>which_state</code>, a state name; and <code>drunk_dr</code>, a logical value (TRUE / FALSE) specifying whether to create separate maps for accidents that were and were not linked to drunk driving. This function should output a map (or two maps if <code>drunk_dr</code> is set to TRUE) with points for all fatal accidents in the state. Use <code>map_data</code> and create the map yourself, rather than using <code>choroplethr</code> for this question. Examples of calling this function are shown below the function definition.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map_fatal_accidents &lt;-<span class="st"> </span>function(<span class="dt">datafr =</span> accident, which_state,
                                <span class="dt">drunk_dr =</span> <span class="ot">FALSE</span>){
  state_accidents &lt;-<span class="st"> </span>datafr %&gt;%
<span class="st">    </span>dplyr::<span class="kw">filter</span>(state_name ==<span class="st"> </span>which_state)
  state_map_data &lt;-<span class="st"> </span>ggplot2::<span class="kw">map_data</span>(<span class="st">&quot;county&quot;</span>, <span class="dt">region =</span> which_state)
  
  accident_map &lt;-<span class="st"> </span>ggplot2::<span class="kw">ggplot</span>(state_map_data,
                                  ggplot2::<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, 
                                               <span class="dt">group =</span> subregion)) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">geom_polygon</span>(<span class="dt">color =</span> <span class="st">&quot;gray&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>) +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">theme_void</span>() +<span class="st"> </span>
<span class="st">    </span>ggplot2::<span class="kw">geom_point</span>(<span class="dt">data =</span> state_accidents, 
                        ggplot2::<span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> <span class="ot">NULL</span>),
                        <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">size =</span> <span class="fl">0.7</span> )
  
  if(drunk_dr){
    accident_map &lt;-<span class="st"> </span>accident_map +<span class="st"> </span>
<span class="st">      </span>ggplot2::<span class="kw">facet_wrap</span>(~<span class="st"> </span>drunk_dr, <span class="dt">ncol =</span> <span class="dv">2</span>)
  }
  
  <span class="kw">return</span>(accident_map)
}</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_fatal_accidents</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;Colorado&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccy-1.png" width="384" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_fatal_accidents</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;Texas&quot;</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/ccz-1.png" width="412.8" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_fatal_accidents</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;Colorado&quot;</span>, 
                    <span class="dt">drunk_dr =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cda-1.png" width="768" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">map_fatal_accidents</span>(accident, <span class="dt">which_state =</span> <span class="st">&quot;Texas&quot;</span>,
                    <span class="dt">drunk_dr =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="RProgrammingForResearch_files/figure-html/cdb-1.png" width="825.6" style="display: block; margin: auto;" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exploring-data-2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reproducible-research-2.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/geanders/RProgrammingForResearch/edit/master/08-reportingresults2.Rmd",
"text": "Edit"
},
"download": ["RProgrammingForResearch.pdf", "RProgrammingForResearch.epub"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
